<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature Flags Demo - MafClubScore</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        .flag-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .flag-item {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            transition: all 0.3s;
        }
        .flag-item:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        .flag-name {
            font-weight: bold;
            color: #495057;
            margin-bottom: 5px;
        }
        .flag-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        .flag-enabled {
            background: #28a745;
            color: white;
        }
        .flag-disabled {
            background: #6c757d;
            color: white;
        }
        .demo-section {
            margin-top: 30px;
            padding: 20px;
            background: #e9ecef;
            border-radius: 6px;
        }
        .demo-section h3 {
            margin-top: 0;
            color: #495057;
        }
        .console-output {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
            margin-top: 10px;
        }
        .phase-header {
            background: #3498db;
            color: white;
            padding: 10px 15px;
            margin: 20px 0 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .info-box {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üö© Feature Flags Demo</h1>

        <div class="info-box">
            <strong>‚ÑπÔ∏è –ß—Ç–æ —ç—Ç–æ?</strong><br>
            Feature flags –ø–æ–∑–≤–æ–ª—è—é—Ç –≤–∫–ª—é—á–∞—Ç—å/–≤—ã–∫–ª—é—á–∞—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞.
            –í—Å–µ —Ñ–ª–∞–≥–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–∫–ª—é—á–µ–Ω—ã. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ environment variables.
        </div>

        <div id="flags-container"></div>

        <div class="demo-section">
            <h3>üîç –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥</h3>
            <p>–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:</p>
            <div class="console-output">
// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ñ–ª–∞–≥–∏<br>
window.FeatureFlags.getAllFlags()<br>
<br>
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–ª–∞–≥<br>
window.FeatureFlags.isEnabled('NEW_AUTH_SYSTEM')<br>
<br>
// –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Ñ–ª–∞–≥–∞<br>
window.FeatureFlags.getFlag('XSS_PROTECTION')
            </div>
        </div>

        <div class="demo-section">
            <h3>üìù –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ</h3>
            <div class="console-output">
import { isEnabled } from './shared/feature-flags.js';<br>
<br>
if (isEnabled('XSS_PROTECTION')) {<br>
&nbsp;&nbsp;// –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥<br>
&nbsp;&nbsp;const elem = document.createElement('div');<br>
&nbsp;&nbsp;elem.textContent = userData;<br>
} else {<br>
&nbsp;&nbsp;// –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–±<br>
&nbsp;&nbsp;element.innerHTML = userData;<br>
}
            </div>
        </div>
    </div>

    <script type="module">
        import { getAllFlags, isEnabled, getFlag } from './shared/feature-flags.js';

        // –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Ñ–ª–∞–≥–æ–≤ –ø–æ —Ñ–∞–∑–∞–º
        const flagsByPhase = {
            '–§–∞–∑–∞ 1: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å': [
                { name: 'NEW_AUTH_SYSTEM', desc: 'JWT –≤–º–µ—Å—Ç–æ hardcoded' },
                { name: 'XSS_PROTECTION', desc: '–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ DOM –æ–ø–µ—Ä–∞—Ü–∏–∏' },
                { name: 'STRICT_CORS', desc: '–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π CORS' },
                { name: 'INPUT_VALIDATION', desc: 'Zod –≤–∞–ª–∏–¥–∞—Ü–∏—è' }
            ],
            '–§–∞–∑–∞ 2: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞': [
                { name: 'SHARED_HANDLERS', desc: '–û–±—â–∏–µ API handlers' },
                { name: 'DATABASE_SERVICE', desc: '–°–ª–æ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –ë–î' }
            ],
            '–§–∞–∑–∞ 3: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å': [
                { name: 'QUERY_OPTIMIZATION', desc: '–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã' },
                { name: 'REDIS_CACHE', desc: '–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ' }
            ],
            '–§–∞–∑–∞ 4: –ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª': [
                { name: 'NOTIFICATIONS', desc: '–°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π' },
                { name: 'ADVANCED_STATS', desc: '–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞' },
                { name: 'TOURNAMENTS', desc: '–¢—É—Ä–Ω–∏—Ä—ã' }
            ]
        };

        const container = document.getElementById('flags-container');
        const allFlags = getAllFlags();

        // –†–µ–Ω–¥–µ—Ä–∏–º —Ñ–ª–∞–≥–∏ –ø–æ —Ñ–∞–∑–∞–º
        Object.entries(flagsByPhase).forEach(([phase, flags]) => {
            const phaseHeader = document.createElement('div');
            phaseHeader.className = 'phase-header';
            phaseHeader.textContent = phase;
            container.appendChild(phaseHeader);

            const flagList = document.createElement('div');
            flagList.className = 'flag-list';

            flags.forEach(({ name, desc }) => {
                const enabled = isEnabled(name);

                const flagItem = document.createElement('div');
                flagItem.className = 'flag-item';

                flagItem.innerHTML = `
                    <div class="flag-name">${name}</div>
                    <div style="margin: 5px 0; font-size: 13px; color: #6c757d;">${desc}</div>
                    <span class="flag-status ${enabled ? 'flag-enabled' : 'flag-disabled'}">
                        ${enabled ? '‚úì –í–ö–õ–Æ–ß–ï–ù' : '‚úó –í–´–ö–õ–Æ–ß–ï–ù'}
                    </span>
                `;

                flagList.appendChild(flagItem);
            });

            container.appendChild(flagList);
        });

        // –í—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
        console.log('üö© Feature Flags Demo');
        console.log('='.repeat(50));
        console.log('–í—Å–µ —Ñ–ª–∞–≥–∏:', allFlags);
        console.log('');
        console.log('–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:');
        console.log('  window.FeatureFlags.getAllFlags()');
        console.log('  window.FeatureFlags.isEnabled("NEW_AUTH_SYSTEM")');
        console.log('  window.FeatureFlags.getFlag("XSS_PROTECTION")');
    </script>
</body>
</html>
